


























































































































































































































































































    std::string ReadUsbPath(const po::variables_map& vm);

    IWalletDB::Ptr OpenDataBase(const po::variables_map& vm, const SecString& pass)
    {
        BOOST_ASSERT(vm.count(cli::WALLET_STORAGE) > 0);




        throw std::runtime_error(kErrorWalletNotInitialized);
    

        IWalletDB::Ptr walletDB;

        std::string sPath = ReadUsbPath(vm);
        if (sPath.empty())
            walletDB = walletDB::open(walletPath, pass);
        else
        {
            auto pKeyKeeper = UsbKeyKeeper::Open(sPath);
            walletDB = walletDB::open(walletPath, pass, pKeyKeeper);
            walletDB::setUsbPath(*walletDB, sPath);
        }

        LOG_INFO() << kWalletOpenedMessage;
        return walletDB;
    }






























